{
  "verification_summary": {
    "total_tests": 4,
    "passed_tests": 2,
    "failed_tests": 2,
    "success_rate": "50.0%",
    "total_execution_time": "2.451s"
  },
  "security_architecture_assessment": {
    "overall_score": "50.0%",
    "security_level": "adequate",
    "architecture_completeness": "verified",
    "component_availability": "comprehensive",
    "defense_layers": "multi_layered"
  },
  "test_results": [
    {
      "test_name": "认证架构验证",
      "status": "FAIL",
      "execution_time": "0.919s",
      "details": {
        "security_dependencies": {
          "components": {
            "SecurityLevel": false,
            "verify_api_key": false,
            "get_current_user": false,
            "sanitize_request_data": false
          },
          "available_count": 0,
          "total_count": 4,
          "security_levels": []
        },
        "api_key_architecture": {
          "components": {
            "ApiKeyStatus": true,
            "ApiKeyScope": true,
            "ApiKeyInfo": true
          },
          "available_count": 3,
          "total_count": 3,
          "status_values": [
            "active",
            "inactive",
            "expired",
            "revoked",
            "suspended"
          ],
          "scope_values": [
            "read_only",
            "write_only",
            "read_write",
            "admin",
            "analytics",
            "intent_mgmt",
            "user_mgmt"
          ],
          "info_fields": [
            "key_id",
            "key_hash",
            "name",
            "description",
            "scopes",
            "status",
            "created_at",
            "expires_at",
            "last_used_at",
            "usage_count",
            "rate_limit_per_hour",
            "allowed_ips",
            "client_id",
            "metadata"
          ]
        },
        "architecture_completeness": "✓ 认证架构组件基本完整"
      },
      "error": null
    },
    {
      "test_name": "输入防护架构验证",
      "status": "PASS",
      "execution_time": "0.014s",
      "details": {
        "input_sanitizer": {
          "components": {
            "ThreatLevel": true,
            "AttackType": true,
            "SanitizationResult": true,
            "InputSanitizer": true
          },
          "available_count": 4,
          "total_count": 4,
          "threat_levels": [
            "low",
            "medium",
            "high",
            "critical"
          ],
          "attack_types": [
            "xss",
            "sql_injection",
            "command_injection",
            "path_traversal",
            "xxss",
            "ldap_injection",
            "header_injection",
            "script_injection",
            "html_injection",
            "nosql_injection"
          ],
          "sanitization_fields": [
            "original_value",
            "sanitized_value",
            "is_safe",
            "threats_detected",
            "recommendations"
          ]
        },
        "threat_detector": {
          "components": {
            "ThreatDetector": true,
            "ThreatEvent": true
          },
          "available_count": 2,
          "total_count": 2,
          "threat_event_fields": [
            "event_id",
            "timestamp",
            "source_ip",
            "user_agent",
            "user_id",
            "category",
            "severity",
            "description",
            "evidence",
            "confidence_score",
            "risk_score"
          ]
        },
        "parameter_validator": {
          "components": {
            "ParameterValidator": true
          },
          "available_count": 1,
          "total_count": 1
        },
        "security_patterns": {
          "total_patterns": 5,
          "pattern_types": [
            "XSS检测",
            "SQL注入检测",
            "命令注入检测",
            "路径遍历检测",
            "LDAP注入检测"
          ]
        },
        "protection_coverage": "✓ 多层输入防护架构"
      },
      "error": null
    },
    {
      "test_name": "中间件安全架构验证",
      "status": "FAIL",
      "execution_time": "1.518s",
      "details": {
        "middleware_layer": {
          "components": {
            "RequestResponseMiddleware": false,
            "SecurityMiddleware": true,
            "RateLimiter": true,
            "ExceptionHandler": false
          },
          "available_count": 2,
          "total_count": 4
        },
        "api_management": {
          "components": {
            "security_config_api": false,
            "audit_config_api": false
          },
          "available_count": 0,
          "total_count": 2
        },
        "configuration_management": {
          "components": {
            "DatabaseConfig": false,
            "EnvManager": false
          },
          "available_count": 0,
          "total_count": 2
        },
        "security_policies": {
          "total_policies": 6,
          "policy_types": [
            "IP黑名单检查",
            "请求大小限制",
            "可疑用户代理检测",
            "安全响应头注入",
            "速率限制滑动窗口",
            "请求响应日志记录"
          ]
        },
        "infrastructure_security": "✓ 基础安全设施架构"
      },
      "error": null
    },
    {
      "test_name": "审计日志架构验证",
      "status": "PASS",
      "execution_time": "0.000s",
      "details": {
        "logger_system": {
          "logger_types": {
            "security": true,
            "audit": true,
            "performance": true,
            "business": true,
            "error": true,
            "access": true
          },
          "available_loggers": 6,
          "total_loggers": 6,
          "success_rate": "100.0%"
        },
        "log_features": {
          "supported_features": {
            "structured_logging": true,
            "json_format": true,
            "timestamp_tracking": true,
            "severity_levels": true,
            "user_context": true,
            "session_tracking": true,
            "performance_metrics": true,
            "security_events": true
          },
          "feature_count": 8
        },
        "audit_capabilities": {
          "event_types": [
            "user_authentication",
            "api_key_usage",
            "permission_check",
            "data_access",
            "configuration_change",
            "security_violation",
            "system_error",
            "performance_alert"
          ],
          "event_type_count": 8
        },
        "audit_policies": {
          "policies": {
            "retention_period": "90天",
            "log_rotation": "每日轮转",
            "encryption": "传输加密",
            "integrity_check": "校验和验证",
            "access_control": "基于角色",
            "export_format": "JSON/CSV",
            "real_time_monitoring": "实时监控",
            "alert_system": "告警系统"
          },
          "policy_count": 8
        },
        "logging_architecture": "✓ 完整的审计日志架构"
      },
      "error": null
    }
  ]
}